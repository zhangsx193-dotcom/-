# -*- coding: utf-8 -*-
"""
四大领域-大国工匠精神品质频次统计
运行目录下需存在：
    航天军工.docx
    能源电力.docx
    文化传承.docx
    装备制造.docx
输出：
    航天军工-柱形.csv
    能源电力-柱形.csv
    文化传承-柱形.csv
    装备制造-柱形.csv
"""
import re, pandas as pd
from docx import Document

# ---------- 通用关键词正则（已融合四领域原文高频句）----------
spirit_dict = {
    '精益求精': [
        r'0\.5毫米', r'误差不能超过.*?毫米', r'零误差', r'零缺陷', r'25毫米以内', r'9%', r'滴水不漏', r'精益求精', r'一丝.*?苟',
        r'毫厘不差', r'芝麻粒大小', r'精度能达到毫米级', r'面板的吻合误差不能超过两毫米', r'接缝的间隙必须小于1毫米',
        r'0\.03毫米', r'0\.02毫米', r'0\.005毫米', r'1毫米以内', r'移动距离控制在一毫米以内', r'头发丝.*?1/3', r'头发丝粗细',
        r'不允许超过.*?毫米', r'微米级', r'两丝', r'1 6威尼', r'99\.994%', r'10微米', r'5微米', r'0\.1毫米', r'0\.16毫米'
    ],
    '坚韧不拔': [
        r'咬牙坚持', r'坚持.*?日夜', r'270多天', r'连续.*?焊', r'返工', r'烧坏.*?再修', r'失败.*?次', r'重来',
        r'每天干的是高强度体力活', r'手掌磨出血泡', r'没有淡水', r'住的是草棚', r'4平方米', r'宁让汗水漂起船',
        r'豁出命也要建好', r'冬天来临前', r'吃住在船上', r'昼夜不停', r'一次次进行.*?试验', r'松螺丝、拧螺丝的机械动作',
        r'靠小推车.*?一寸寸地拼接', r'蹲着练习', r'蹲半个小时', r'25年', r'30年', r'40年', r'近四十', r'两千万次',
        r'一万小时定律', r'8000次', r'6000多公里', r'2000多次试验', r'上万次的重复'
    ],
    '创新突破': [
        r'数字化.*?零的突破', r'首创', r'自主研发', r'0到1', r'前所未有', r'第一次.*?设计', r'第一次.*?启用', r'突破',
        r'革命性变革', r'效率提高百倍', r'世界最长外海沉管隧道', r'厘米级精确对接', r'世界天眼', r'500米口径', r'40多万块反射面',
        r'圆规理论', r'原绘模式', r'钢板的自然下垂', r'顺势而下', r'中国奇迹', r'超级工程', r'多个世界之最',
        r'变极性等离子弧焊接', r'秋千法', r'电动液压桥塞坐封工具', r'航空发动机叶片滚轮精密磨削技术', r'电能表自动化检定',
        r'智能化计量检定', r'三级除氢法', r'反变形补偿法', r'风动砂轮纯手工研磨操作法', r'望闻问切', r'蒙眼锉削'
    ],
    '敬业奉献': [
        r'一辈子的事业', r'自豪', r'荣耀', r'使命', r'我的名字.*?绑在那', r'默默奉献', r'无涉名利',
        r'生在这个时代', r'参与这么重要的一个型号', r'幸运', r'无法用语言来形容', r'亲历者',
        r'光荣退休证挂在客厅', r'不是国产的飞机就不坐', r'等着中国大飞机重启', r'放弃每个月五六千元收入',
        r'先当三个月的施工', r'每天清晨第一个来到车间', r'只专注于钣金工作', r'择一事终一生', r'守艺人',
        r'把产品当作艺术品来雕琢', r'把航天品质当作生命来守护', r'国为重、家为轻', r'择一事终一生'
    ],
    '责任担当': [
        r'核安全', r'飞行中解体', r'船毁人亡', r'泄漏', r'生态环境', r'后果不堪设想', r'终身负责', r'刻工号',
        r'飞机上任何一个小孔出现问题', r'可能导致飞行中解体', r'核电站相当于就报废了', r'对生态环境产生很大的影响',
        r'焊条燃烧过程中产生气孔', r'应力集中', r'容易产生裂纹', r'接口可能断裂',
        r'我的名字那道口和我的名字紧紧绑在那', r'干不好那就是我的耻辱', r'不允许任何隐患出坞门',
        r'100-1=0', r'零缺陷', r'万无一失', r'把每一枚弹药都当作工艺品', r'把每一颗螺钉拧紧力矩保持一致'
    ]
}

# ---------- 统计函数 ----------
def count_spirit(docx_file):
    text = '\n'.join(p.text for p in Document(docx_file).paragraphs if p.text.strip())
    counter = {k: sum(len(re.findall(pat, text, flags=re.I)) for pat in v) for k, v in spirit_dict.items()}
    df = (pd.Series(counter, name='频次')
            .rename_axis('精神品质')
            .reset_index()
            .sort_values('频次', ascending=False))
    out_csv = docx_file.replace('.docx', '-柱形.csv')
    df.to_csv(out_csv, index=False, encoding='utf-8-sig')
    print(f'\n{docx_file}  ->  {out_csv}')
    print(df)
    return df

# ---------- 一键执行 ----------
for file in ['航天军工.docx', '能源电力.docx', '文化传承.docx', '装备制造.docx']:
    count_spirit(file)
