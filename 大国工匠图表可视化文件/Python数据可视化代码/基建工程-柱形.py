# -*- coding: utf-8 -*-
import re, pandas as pd
from docx import Document

# 1. 读全文
text = '\n'.join(p.text for p in Document('基建工程.docx').paragraphs if p.text.strip())

# 2. 5 个精神品质的关键词正则（按实际原文提炼）
# 仅替换 spirit_dict 部分，其余保持
spirit_dict = {
    '精益求精': [
        # 原有
        r'0\.5毫米', r'误差不能超过.*?毫米', r'零误差', r'零缺陷', r'25毫米以内', r'9%', r'滴水不漏', r'精益求精', r'一丝.*?苟',
        # 新增——全部出自原文
        r'毫厘不差', r'芝麻粒大小', r'精度能达到毫米级', r'误差不超过.*?毫米', r'面板的吻合误差不能超过两毫米',
        r'接缝的间隙必须小于1毫米', r'用手摸一摸盘面', r'再检查一次', r'反复检查', r'不让隐患出坞门',
        r'听感绝技', r'手感', r'99%提高到99\.99%', r'研磨油', r'砂纸上均匀地画圈'
    ],

    '坚韧不拔': [
        # 原有
        r'咬牙坚持', r'坚持.*?日夜', r'270多天', r'连续.*?焊', r'返工', r'烧坏.*?再修', r'失败.*?次', r'重来',
        # 新增
        r'每天干的是高强度体力活', r'手掌磨出血泡', r'没有淡水', r'住的是草棚', r'4平方米',
        r'宁让汗水漂起船', r'豁出命也要建好', r'冬天来临前', r'吃住在船上', r'昼夜不停',
        r'一次次进行.*?试验', r'松螺丝、拧螺丝的机械动作', r'靠小推车.*?一寸寸地拼接'
    ],

    '创新突破': [
        # 原有
        r'数字化.*?零的突破', r'首创', r'自主研发', r'0到1', r'前所未有', r'第一次.*?设计', r'第一次.*?启用', r'突破',
        # 新增
        r'革命性变革', r'大飞机机身数字化装配零的突破', r'效率提高百倍', r'世界最长外海沉管隧道', r'厘米级精确对接',
        r'世界天眼', r'500米口径', r'40多万块反射面', r'圆规理论', r'原绘模式',
        r'钢板的自然下垂', r'顺势而下', r'中国奇迹', r'超级工程', r'多个世界之最'
    ],

    '敬业奉献': [
        # 原有
        r'一辈子的事业', r'自豪', r'荣耀', r'使命', r'我的名字.*?绑在那', r'默默奉献', r'无涉名利',
        # 新增
        r'生在这个时代', r'参与这么重要的一个型号', r'幸运', r'无法用语言来形容', r'亲历者',
        r'光荣退休证挂在客厅', r'不是国产的飞机就不坐', r'等着中国大飞机重启', r'放弃每个月五六千元收入',
        r'先当三个月的施工', r'每天清晨第一个来到车间', r'只专注于钣金工作'
    ],

    '责任担当': [
        # 原有
        r'核安全', r'飞行中解体', r'船毁人亡', r'泄漏', r'生态环境', r'后果不堪设想', r'终身负责', r'刻工号',
        # 新增
        r'飞机上任何一个小孔出现问题', r'可能导致飞行中解体', r'核电站相当于就报废了', r'对生态环境产生很大的影响',
        r'焊条燃烧过程中产生气孔', r'应力集中', r'容易产生裂纹', r'接口可能断裂',
        r'我的名字那道口和我的名字紧紧绑在那', r'干不好那就是我的耻辱', r'不允许任何隐患出坞门'
    ]
}

# 3. 关键词级计数
counter = {}
for spirit, kw_list in spirit_dict.items():
    counter[spirit] = sum(len(re.findall(kw, text, flags=re.I)) for kw in kw_list)

# 4. 输出
df = (pd.Series(counter, name='频次')
        .rename_axis('精神品质')
        .reset_index()
        .sort_values('频次', ascending=False))
df.to_csv('大国工匠精神品质频次.csv', index=False, encoding='utf-8-sig')
print(df)
